<!DOCTYPE html>

<html lang = "en">
    <head>
        <title>Reassure</title>

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <!-- Bootstrap -->
        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
        
        <!-- jQuery library -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        
        <!-- Popper JS -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
        
        <!-- Latest compiled JavaScript -->
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

        <!--DEPENDENCIES:-->
        <!-- The core Firebase JS SDK is always required and must be listed first -->
        <!-- Insert these scripts at the bottom of the HTML, but before you use any Firebase services -->

        <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
        <script src="https://www.gstatic.com/firebasejs/8.2.6/firebase-app.js"></script>

        <!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics -->
        <script src="https://www.gstatic.com/firebasejs/8.2.6/firebase-analytics.js"></script>

        <!-- Add Firebase products that you want to use -->
        <script src="https://www.gstatic.com/firebasejs/8.2.6/firebase-auth.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.2.6/firebase-firestore.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.2.6/firebase-database.js"></script>
        
        <link rel="stylesheet" href="../Styles/style.css">
        <script src="../Scripts/script.js"></script>
        <script src="../Scripts/serverInterface.js"></script>

        <script>
            var keys = [];

            function loadpage(){
                var cardParent = document.getElementById("requests");
                initHelp();


                //alert("inithelp called");
                
                //try setTimeout(500)? and see if that solves it idk does it work? oh ok
                //I think that function is executed only after this one returns, maybe just use a button to fetch cards for now
                //no wait, it's not waiting at all

                
                //make this into a function, and have a button that calls it 
                // for(var i = 0; i < 3; i++){
                    
                //     var userReq = document.getElementById("req" + (i + 1));
                //     var req = getAPost();
                //     alert(req);//shows 3 'undefined's
                //     userReq.innerHTML = req;
                // }  
                    

                //while(!done);

                // for(var i = 0; i < 3; i++){
                    
                //     var userReq = document.getElementById("req" + (i + 1));
                //     var req = getAPost();
                //     alert(req);//shows 3 'undefined's
                //     userReq.innerHTML = req;
                // }
            }
            
            function replace(i){
                var userReq = document.getElementById("req" + (i + 1));
                    var req = getAPost();
                    //alert(req[0]);
                    //alert(req[1]);
                    
                    console.log(req.keey);
                    userReq.innerHTML = req.value;
                    //var keytemp = keys;
                    //keys.length = 0;
                    // for(var j = 0; j < 3; j++){
                    //     if(j != i){
                    //         keys.push(keytemp[j]);
                    //     }
                    //     else{
                    //         keys.push(req.key);
                    //     }
                    // }
                    keys[i] = req.keey;
            }

            function dothis(){
                keys.length = 0;
                for(var i = 0; i < 3; i++){
                    var userReq = document.getElementById("req" + (i + 1));
                    var req = getAPost();
                    //alert(req[0]);
                    //alert(req[1]);
                    //maybe returning an array is a bad idea?
                    console.log(req.keey);
                    userReq.innerHTML = req.value;
                    keys.push(req.keey);
                }  
            }
        </script>
    </head>

    

    <body onload="loadpage()">
    
        <span style="font-size:20px;cursor:pointer" onclick="openNav()" id="opennav" class="container menu">&#9776; Menu</span> <!-- this i think contains the code to reopen it-->
        <div id="mySidenav" class="sidenav">
            <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
            <a href="index.html">Ask for Help</a>
            <a href="#">Help others</a>
            <a href="#">Get Replies</a>
        </div>

        <section class="container-fluid row justify-content-center">
           
            <h3>
                Help others and help yourself!
            </h3>
        </section>
        <section class="container-fluid row justify-content-center">
            <p>
                Our goal is to encourage people to voice their thoughts and feelings during the global
                pandemic in the form of a short letter. Other people can reply to those letters and generate
                positive vibes.
            </p>
        </section>

        <section class="container-fluid row" id="requests">
            <div class="col card" id="card1">
                <h1>
                    Write your response here!
                </h1>
                <p id="req1">the request of other users</p>

                <form onsubmit="writeResponse(keys[0], reply1); replace(0); return false" method="POST">
                    <div>
                        <textarea name="reply1" id="reply1"></textarea>
                    </div>
                    <div>
                        <input type="submit" class="submit" value="Send"  onclick="removeCard(this)"/>
                    </div>
                </form>
            </div>

            <div class="col card" id="card2">
                <h1>
                    Write your response here!
                </h1>
                <p id="req2">the request of other users</p>
                <form onsubmit="writeResponse(keys[1], reply2); replace(1); return false" method="POST">
                    <div>
                        <textarea name="reply2" id="reply2"></textarea>
                    </div>
                    <div>
                        <input type="submit" class="submit" value="Send"/>
                    </div>
                </form>
            </div>

            <div class="col card" id="card3">
                <h1>
                    Write your response here!
                </h1>
                <p id="req3">the request of other users</p>
                <form onsubmit="writeResponse(keys[2], reply3); replace(2); return false" method="POST">
                    <div>
                        <textarea name="reply3" id="reply3"></textarea>
                    </div>
                    <div>
                        <input type="submit" class="submit" value="Send"/>
                    </div>
                </form>

            </div>
        </section>
        
    <div class="container">
        <button type="button" onclick="dothis()">
            Click
        </button>
    </div>
        <footer class="container-fluid row justify-content-center fixed-bottom">
            Footer
        </footer>

    </body>
</html>